/*
 *  This is compiled version of comment-anything-fp-client, commenting
 *  written in PureScript.
 *  See https://github.com/caryoscelus/comment-anything-fp-client for
 *  details and source code.
 *
 *  Copyright (C) 2014 caryoscelus
 *  
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *  
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *  
 *  See <http://www.gnu.org/licenses/>.
 */
// Generated by psc version 0.6.1.2
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    var Unit = {
        create: function (value) {
            return value;
        }
    };
    function LT() {

    };
    LT.value = new LT();
    function GT() {

    };
    GT.value = new GT();
    function EQ() {

    };
    EQ.value = new EQ();
    function Semigroupoid($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    function Category(__superclass_Prelude$dotSemigroupoid_0, id) {
        this["__superclass_Prelude.Semigroupoid_0"] = __superclass_Prelude$dotSemigroupoid_0;
        this.id = id;
    };
    function Show(show) {
        this.show = show;
    };
    function Functor($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    function Apply($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    function Applicative(__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    function Bind($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    function Monad(__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    function Eq($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    function Ord(__superclass_Prelude$dotEq_0, compare) {
        this["__superclass_Prelude.Eq_0"] = __superclass_Prelude$dotEq_0;
        this.compare = compare;
    };
    function BoolLike($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    function Semigroup($less$greater) {
        this["<>"] = $less$greater;
    };
    function cons(e) {  return function(l) {    return [e].concat(l);  };};
    function refEq(r1) {  return function(r2) {    return r1 === r2;  };};
    function refIneq(r1) {  return function(r2) {    return r1 !== r2;  };};
    function unsafeCompareImpl(lt) {  return function(eq) {    return function(gt) {      return function(x) {        return function(y) {          return x < y ? lt : x > y ? gt : eq;        };      };    };  };};
    function boolAnd(b1) {  return function(b2) {    return b1 && b2;  };};
    function boolOr(b1) {  return function(b2) {    return b1 || b2;  };};
    function boolNot(b) {  return !b;};
    function concatString(s1) {  return function(s2) {    return s1 + s2;  };};
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $greater$greater$greater = function (__dict_Semigroupoid_0) {
        return function (f) {
            return function (g) {
                return $less$less$less(__dict_Semigroupoid_0)(g)(f);
            };
        };
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $colon = cons;
    var $plus$plus = function (__dict_Semigroup_2) {
        return $less$greater(__dict_Semigroup_2);
    };
    var $amp$amp = function (dict) {
        return dict["&&"];
    };
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var unsafeCompare = unsafeCompareImpl(LT.value)(EQ.value)(GT.value);
    var unit = {};
    var show = function (dict) {
        return dict.show;
    };
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupString = new Semigroup(concatString);
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_5) {
        return pure(__dict_Monad_5["__superclass_Prelude.Applicative_0"]());
    };
    var not = function (dict) {
        return dict.not;
    };
    var liftA1 = function (__dict_Applicative_7) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_7["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_7)(f))(a);
            };
        };
    };
    var id = function (dict) {
        return dict.id;
    };
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqString = new Eq(refIneq, refEq);
    var ordString = new Ord(function () {
        return eqString;
    }, unsafeCompare);
    var eqNumber = new Eq(refIneq, refEq);
    var $$const = function (_33) {
        return function (_34) {
            return _33;
        };
    };
    var compare = function (dict) {
        return dict.compare;
    };
    var $less = function (__dict_Ord_11) {
        return function (a1) {
            return function (a2) {
                var _403 = compare(__dict_Ord_11)(a1)(a2);
                if (_403 instanceof LT) {
                    return true;
                };
                return false;
            };
        };
    };
    var $less$eq = function (__dict_Ord_12) {
        return function (a1) {
            return function (a2) {
                var _404 = compare(__dict_Ord_12)(a1)(a2);
                if (_404 instanceof GT) {
                    return false;
                };
                return true;
            };
        };
    };
    var categoryArr = new Category(function () {
        return semigroupoidArr;
    }, function (x) {
        return x;
    });
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var ap = function (__dict_Monad_15) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_15)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        "$": $dollar, 
        "&&": $amp$amp, 
        "++": $plus$plus, 
        ":": $colon, 
        "<": $less, 
        "<$>": $less$dollar$greater, 
        "<*>": $less$times$greater, 
        "<<<": $less$less$less, 
        "<=": $less$eq, 
        "<>": $less$greater, 
        "==": $eq$eq, 
        ">>=": $greater$greater$eq, 
        ">>>": $greater$greater$greater, 
        Applicative: Applicative, 
        Apply: Apply, 
        Bind: Bind, 
        BoolLike: BoolLike, 
        Category: Category, 
        EQ: EQ, 
        Eq: Eq, 
        Functor: Functor, 
        GT: GT, 
        LT: LT, 
        Monad: Monad, 
        Ord: Ord, 
        Semigroup: Semigroup, 
        Semigroupoid: Semigroupoid, 
        Show: Show, 
        Unit: Unit, 
        ap: ap, 
        boolLikeBoolean: boolLikeBoolean, 
        categoryArr: categoryArr, 
        compare: compare, 
        cons: cons, 
        "const": $$const, 
        eqNumber: eqNumber, 
        eqString: eqString, 
        flip: flip, 
        id: id, 
        liftA1: liftA1, 
        not: not, 
        ordString: ordString, 
        pure: pure, 
        refEq: refEq, 
        refIneq: refIneq, 
        "return": $$return, 
        semigroupString: semigroupString, 
        semigroupoidArr: semigroupoidArr, 
        show: show, 
        unit: unit
    };
})();
var PS = PS || {};
PS.Network_XHR_Types = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function UNSENT() {

    };
    UNSENT.value = new UNSENT();
    function OPENED() {

    };
    OPENED.value = new OPENED();
    function HEADERSRECEIVED() {

    };
    HEADERSRECEIVED.value = new HEADERSRECEIVED();
    function LOADING() {

    };
    LOADING.value = new LOADING();
    function DONE() {

    };
    DONE.value = new DONE();
    function UNKNOWN(value0) {
        this.value0 = value0;
    };
    UNKNOWN.create = function (value0) {
        return new UNKNOWN(value0);
    };
    function NoBody() {

    };
    NoBody.value = new NoBody();
    function RawBody(value0) {
        this.value0 = value0;
    };
    RawBody.create = function (value0) {
        return new RawBody(value0);
    };
    function UrlEncoded(value0) {
        this.value0 = value0;
    };
    UrlEncoded.create = function (value0) {
        return new UrlEncoded(value0);
    };
    function Multipart(value0) {
        this.value0 = value0;
    };
    Multipart.create = function (value0) {
        return new Multipart(value0);
    };
    var parseReadyState = function (i) {
        if (i === 0) {
            return UNSENT.value;
        };
        if (i === 1) {
            return OPENED.value;
        };
        if (i === 2) {
            return HEADERSRECEIVED.value;
        };
        if (i === 3) {
            return LOADING.value;
        };
        if (i === 4) {
            return DONE.value;
        };
        return new UNKNOWN(i);
    };
    var eqReadyState = new Prelude.Eq(function (a) {
        return function (b) {
            return !Prelude["=="](eqReadyState)(a)(b);
        };
    }, function (_54) {
        return function (_55) {
            if (_54 instanceof UNSENT && _55 instanceof UNSENT) {
                return true;
            };
            if (_54 instanceof OPENED && _55 instanceof OPENED) {
                return true;
            };
            if (_54 instanceof HEADERSRECEIVED && _55 instanceof HEADERSRECEIVED) {
                return true;
            };
            if (_54 instanceof LOADING && _55 instanceof LOADING) {
                return true;
            };
            if (_54 instanceof DONE && _55 instanceof DONE) {
                return true;
            };
            if (_54 instanceof UNKNOWN && _55 instanceof UNKNOWN) {
                return _54.value0 === _55.value0;
            };
            return false;
        };
    });
    return {
        DONE: DONE, 
        HEADERSRECEIVED: HEADERSRECEIVED, 
        LOADING: LOADING, 
        Multipart: Multipart, 
        NoBody: NoBody, 
        OPENED: OPENED, 
        RawBody: RawBody, 
        UNKNOWN: UNKNOWN, 
        UNSENT: UNSENT, 
        UrlEncoded: UrlEncoded, 
        eqReadyState: eqReadyState, 
        parseReadyState: parseReadyState
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function runFn2(fn) {  return function(a) {    return function(b) {      return fn(a, b);    };  };};
    function runFn3(fn) {  return function(a) {    return function(b) {      return function(c) {        return fn(a, b, c);      };    };  };};
    return {
        runFn2: runFn2, 
        runFn3: runFn3
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function returnE(a) {  return function() {    return a;  };};
    function bindE(a) {  return function(f) {    return function() {      return f(a())();    };  };};
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        applicativeEff: applicativeEff, 
        applyEff: applyEff, 
        bindE: bindE, 
        bindEff: bindEff, 
        functorEff: functorEff, 
        monadEff: monadEff, 
        returnE: returnE
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Unsafe_Element = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function unsafeGetElementById(targ_id) {        return function (src) {                         return function () {                            return src.getElementById(targ_id);         };                                          };                                          };
    function unsafeGetElementsByClassName(targ_id) {     return function (src) {                              return function () {                                 return src.getElementsByClassName(targ_id);      };                                               }                                                };
    function unsafeGetElementsByName(targ_id) {        return function (src) {                            return function () {                               return src.getElementsByName(targ_id);         };                                             };                                             };
    function unsafeQuerySelector(selector) {     return function (src) {                      return function () {                         return src.querySelector(selector);      };                                       };                                       };
    function unsafeQuerySelectorAll(selector) {    return function (src) {                        return function () {                           return src.querySelectorAll(selector);     };                                         };                                         };
    function unsafeGetAttribute(name) {        return function (src) {                    return function () {                       return src.getAttribute(name);         };                                     };                                     };
    function unsafeSetAttribute(name) {        return function (value) {                  return function (src) {                    return function () {                       src.setAttribute(name, value);           return {};                             };                                     };                                     };                                     };
    function unsafeHasAttribute(name) {        return function (src) {                    return function () {                       return src.hasAttribute(name);         };                                     };                                     };
    function unsafeRemoveAttribute(name) {     return function (src) {                    return function () {                       src.removeAttribute(name);               return {};                             };                                     };                                     };
    function unsafeChildren(src) {               return function () {                       return src.children;                 };                                     };
    function unsafeInnerHTML(src) {            return function () {                       return src.innerHTML;                  };                                     };
    function unsafeSetInnerHTML(value) {       return function (src) {                    return function () {                       src.innerHTML = value;                   return {};                             };                                     };                                     };
    function unsafeTextContent(src) {          return function () {                       return src.textContent;                };                                     };
    function unsafeSetTextContent(value) {     return function (src) {                    return function () {                       src.textContent = value;                 return {};                             };                                     };                                     };
    function unsafeValue(src) {                return function () {                       return src.value;                      };                                     };
    function unsafeSetValue(value) {           return function (src) {                    return function () {                       src.value = value;                       return {};                             };                                     };                                     };
    function unsafeContentWindow(obj) {    return function () {                   return obj.contentWindow;          };                                 };
    function unsafeClassAdd(value) {           return function (src) {                    return function () {                       src.classList.add(value);                return {};                             };                                     };                                     };
    function unsafeClassRemove(value) {        return function (src) {                    return function () {                       src.classList.remove(value);             return {};                             };                                     };                                     };
    function unsafeClassToggle(value) {        return function (src) {                    return function () {                       src.classList.toggle(value);             return {};                             };                                     };                                     };
    function unsafeClassContains(value) {          return function (src) {                        return function () {                           return src.classList.contains(value);      };                                         };                                         };
    return {
        unsafeChildren: unsafeChildren, 
        unsafeClassAdd: unsafeClassAdd, 
        unsafeClassContains: unsafeClassContains, 
        unsafeClassRemove: unsafeClassRemove, 
        unsafeClassToggle: unsafeClassToggle, 
        unsafeContentWindow: unsafeContentWindow, 
        unsafeGetAttribute: unsafeGetAttribute, 
        unsafeGetElementById: unsafeGetElementById, 
        unsafeGetElementsByClassName: unsafeGetElementsByClassName, 
        unsafeGetElementsByName: unsafeGetElementsByName, 
        unsafeHasAttribute: unsafeHasAttribute, 
        unsafeInnerHTML: unsafeInnerHTML, 
        unsafeQuerySelector: unsafeQuerySelector, 
        unsafeQuerySelectorAll: unsafeQuerySelectorAll, 
        unsafeRemoveAttribute: unsafeRemoveAttribute, 
        unsafeSetAttribute: unsafeSetAttribute, 
        unsafeSetInnerHTML: unsafeSetInnerHTML, 
        unsafeSetTextContent: unsafeSetTextContent, 
        unsafeSetValue: unsafeSetValue, 
        unsafeTextContent: unsafeTextContent, 
        unsafeValue: unsafeValue
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Unsafe_Events = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function unsafeAddEventListener(targ) {                return function (cb) {                                  return function (src) {                                return function () {                                   src.addEventListener(targ, function(evt) {             cb(evt)();                                         });                                                };                                                 };                                                };                                                 };
    function unsafeRemoveEventListener(targ) {                 return function (cb) {                                      return function (src) {                                    return function () {                                       src.removeEventListener(targ, function (evt) {             cb(evt)();                                             });                                                    };                                                     };                                                    };                                                     };
    function unsafeEventTarget(event) {   return function () {             return event.target;         };                           };
    function unsafeStopPropagation(event) {   return function () {               event.stopPropagation();        }                              };
    function unsafePreventDefault(event) {   return function () {               event.preventDefault();        }                              };
    function unsafeEventNumberProp(prop) {    return function (event) {                 return function() {                       return event[prop];                   };                                    };                                    };
    function unsafeEventView(event) {   return function() {                 return event.view;              };                              };
    return {
        unsafeAddEventListener: unsafeAddEventListener, 
        unsafeEventNumberProp: unsafeEventNumberProp, 
        unsafeEventTarget: unsafeEventTarget, 
        unsafeEventView: unsafeEventView, 
        unsafePreventDefault: unsafePreventDefault, 
        unsafeRemoveEventListener: unsafeRemoveEventListener, 
        unsafeStopPropagation: unsafeStopPropagation
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Unsafe_Window = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function unsafeDocument(win) {      return function () {                return win.document;            };                              };
    function unsafeLocation(win) {     return function () {               return win.location;           };                             };
    function unsafeSetTimeout(win) {   return function(delay) {     return function(func) {       return function() {         return win.setTimeout(func, delay);       };     };   }; };
    function unsafeSetInterval(win) {   return function(delay) {     return function(func) {       return function() {         return win.setInterval(func, delay);       };     };   }; };
    function unsafeClearTimeout(win) {   return function(timeout) {     return function() {       win.clearTimeout(timeout);     };   }; };
    function unsafeInnerWidth(win) {   return function() {     return win.innerWidth;   }; };
    function unsafeInnerHeight(win) {   return function() {     return win.innerHeight;   }; };
    return {
        unsafeClearTimeout: unsafeClearTimeout, 
        unsafeDocument: unsafeDocument, 
        unsafeInnerHeight: unsafeInnerHeight, 
        unsafeInnerWidth: unsafeInnerWidth, 
        unsafeLocation: unsafeLocation, 
        unsafeSetInterval: unsafeSetInterval, 
        unsafeSetTimeout: unsafeSetTimeout
    };
})();
var PS = PS || {};
PS.Date = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function getDate () {
        return (new Date()).toString();
    }
    ;
    return {
        getDate: getDate
    };
})();
var PS = PS || {};
PS.Debug_Trace = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function trace(s) {  return function() {    console.log(s);    return {};  };};
    return {
        trace: trace
    };
})();
var PS = PS || {};
PS.Control_Apply = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $times$greater = function (__dict_Apply_35) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_35)(Prelude["<$>"](__dict_Apply_35["__superclass_Prelude.Functor_0"]())(Prelude["const"](Prelude.id(Prelude.categoryArr)))(a))(b);
            };
        };
    };
    return {
        "*>": $times$greater
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Left(value0) {
        this.value0 = value0;
    };
    Left.create = function (value0) {
        return new Left(value0);
    };
    function Right(value0) {
        this.value0 = value0;
    };
    Right.create = function (value0) {
        return new Right(value0);
    };
    var functorEither = new Prelude.Functor(function (_80) {
        return function (_81) {
            if (_81 instanceof Left) {
                return new Left(_81.value0);
            };
            if (_81 instanceof Right) {
                return new Right(_80(_81.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var either = function (_77) {
        return function (_78) {
            return function (_79) {
                if (_79 instanceof Left) {
                    return _77(_79.value0);
                };
                if (_79 instanceof Right) {
                    return _78(_79.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var applyEither = new Prelude.Apply(function (_82) {
        return function (_83) {
            if (_82 instanceof Left) {
                return new Left(_82.value0);
            };
            if (_82 instanceof Right) {
                return Prelude["<$>"](functorEither)(_82.value0)(_83);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var bindEither = new Prelude.Bind(either(function (e) {
        return function (_) {
            return new Left(e);
        };
    })(function (a) {
        return function (f) {
            return f(a);
        };
    }), function () {
        return applyEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    var monadEither = new Prelude.Monad(function () {
        return applicativeEither;
    }, function () {
        return bindEither;
    });
    return {
        Left: Left, 
        Right: Right, 
        applicativeEither: applicativeEither, 
        applyEither: applyEither, 
        bindEither: bindEither, 
        either: either, 
        functorEither: functorEither, 
        monadEither: monadEither
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Nothing() {

    };
    Nothing.value = new Nothing();
    function Just(value0) {
        this.value0 = value0;
    };
    Just.create = function (value0) {
        return new Just(value0);
    };
    var maybe = function (_91) {
        return function (_92) {
            return function (_93) {
                if (_93 instanceof Nothing) {
                    return _91;
                };
                if (_93 instanceof Just) {
                    return _92(_93.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    return {
        Just: Just, 
        Nothing: Nothing, 
        maybe: maybe
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    function append (l1) {  return function (l2) {    return l1.concat(l2);  };};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    var semigroupArray = new Prelude.Semigroup(append);
    var functorArray = new Prelude.Functor(map);
    return {
        append: append, 
        functorArray: functorArray, 
        map: map, 
        semigroupArray: semigroupArray
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Unsafe_Utils = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    function ensure3(nothing) {   return function(just) {     return function(v) {       if (v === undefined || v === null)         return nothing;       else         return just(v);     }  } };
    var ensure = ensure3(Data_Maybe.Nothing.value)(Data_Maybe.Just.create);
    return {
        ensure: ensure, 
        ensure3: ensure3
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Monoid(__superclass_Prelude$dotSemigroup_0, mempty) {
        this["__superclass_Prelude.Semigroup_0"] = __superclass_Prelude$dotSemigroup_0;
        this.mempty = mempty;
    };
    var monoidString = new Monoid(function () {
        return Prelude.semigroupString;
    }, "");
    var mempty = function (dict) {
        return dict.mempty;
    };
    return {
        Monoid: Monoid, 
        mempty: mempty, 
        monoidString: monoidString
    };
})();
var PS = PS || {};
PS.Data_Tuple = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Lazy = PS.Control_Lazy;
    var Data_Array = PS.Data_Array;
    function Tuple(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Tuple.create = function (value0) {
        return function (value1) {
            return new Tuple(value0, value1);
        };
    };
    var snd = function (_189) {
        return _189.value1;
    };
    var fst = function (_188) {
        return _188.value0;
    };
    return {
        Tuple: Tuple, 
        fst: fst, 
        snd: snd
    };
})();
var PS = PS || {};
PS.Text_Smolder_Markup = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Parent(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Parent.create = function (value0) {
        return function (value1) {
            return new Parent(value0, value1);
        };
    };
    function Leaf(value0) {
        this.value0 = value0;
    };
    Leaf.create = function (value0) {
        return new Leaf(value0);
    };
    function Content(value0) {
        this.value0 = value0;
    };
    Content.create = function (value0) {
        return new Content(value0);
    };
    function Append(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Append.create = function (value0) {
        return function (value1) {
            return new Append(value0, value1);
        };
    };
    function AddAttribute(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    AddAttribute.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new AddAttribute(value0, value1, value2);
            };
        };
    };
    function Empty() {

    };
    Empty.value = new Empty();
    var Attribute = {
        create: function (value) {
            return value;
        }
    };
    function Attributable($bang) {
        this["!"] = $bang;
    };
    function slightlyUnsafeCoerce(a) {return a;};
    
  function horriblyUnsafeBind(ma) {
    return function(f) {
      return new Append(ma, f());
    }
  }
;
    var $bang = function (dict) {
        return dict["!"];
    };
    var text = function (s) {
        return new Content(s);
    };
    var functorMarkupM = new Prelude.Functor(function (_220) {
        return slightlyUnsafeCoerce;
    });
    var attribute = function (key) {
        return function (value) {
            return AddAttribute.create(key)(value);
        };
    };
    var attributableMarkupMF = new Attributable(function (_226) {
        return function (_227) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(_227)(_226);
        };
    });
    var attributableMarkupM = new Attributable(function (_224) {
        return function (_225) {
            return _225(_224);
        };
    });
    var monadMarkupM = new Prelude.Monad(function () {
        return applicativeMarkupM;
    }, function () {
        return bindMarkupM;
    });
    var bindMarkupM = new Prelude.Bind(horriblyUnsafeBind, function () {
        return applyMarkupM;
    });
    var applyMarkupM = new Prelude.Apply(Prelude.ap(monadMarkupM), function () {
        return functorMarkupM;
    });
    var applicativeMarkupM = new Prelude.Applicative(function () {
        return applyMarkupM;
    }, function (_221) {
        return Empty.value;
    });
    return {
        "!": $bang, 
        AddAttribute: AddAttribute, 
        Append: Append, 
        Attributable: Attributable, 
        Attribute: Attribute, 
        Content: Content, 
        Empty: Empty, 
        Leaf: Leaf, 
        Parent: Parent, 
        applicativeMarkupM: applicativeMarkupM, 
        applyMarkupM: applyMarkupM, 
        attributableMarkupM: attributableMarkupM, 
        attributableMarkupMF: attributableMarkupMF, 
        attribute: attribute, 
        bindMarkupM: bindMarkupM, 
        functorMarkupM: functorMarkupM, 
        monadMarkupM: monadMarkupM, 
        text: text
    };
})();
var PS = PS || {};
PS.Text_Smolder_HTML = (function () {
    "use strict";
    var Text_Smolder_Markup = PS.Text_Smolder_Markup;
    var textarea = Text_Smolder_Markup.Parent.create("textarea");
    var p = Text_Smolder_Markup.Parent.create("p");
    var input = new Text_Smolder_Markup.Leaf("input");
    var h2 = Text_Smolder_Markup.Parent.create("h2");
    var form = Text_Smolder_Markup.Parent.create("form");
    var div = Text_Smolder_Markup.Parent.create("div");
    var br = new Text_Smolder_Markup.Leaf("br");
    return {
        br: br, 
        div: div, 
        form: form, 
        h2: h2, 
        input: input, 
        p: p, 
        textarea: textarea
    };
})();
var PS = PS || {};
PS.Text_Smolder_HTML_Attributes = (function () {
    "use strict";
    var Text_Smolder_Markup = PS.Text_Smolder_Markup;
    var value = Text_Smolder_Markup.attribute("value");
    var type$prime = Text_Smolder_Markup.attribute("type");
    var className = Text_Smolder_Markup.attribute("class");
    return {
        className: className, 
        "type'": type$prime, 
        value: value
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Data_Monoid = PS.Data_Monoid;
    var Prelude = PS.Prelude;
    var Control_Apply = PS.Control_Apply;
    var Data_Monoid_First = PS.Data_Monoid_First;
    function Foldable(foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    function foldrArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = xs.length - 1; i >= 0; --i) {        acc = f(xs[i])(acc);      }      return acc;    }  }};
    function foldlArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = 0, len = xs.length; i < len; ++i) {        acc = f(acc)(xs[i]);      }      return acc;    }  }};
    var foldr = function (dict) {
        return dict.foldr;
    };
    var traverse_ = function (__dict_Applicative_96) {
        return function (__dict_Foldable_97) {
            return function (f) {
                return foldr(__dict_Foldable_97)(Prelude["<<<"](Prelude.semigroupoidArr)(Control_Apply["*>"](__dict_Applicative_96["__superclass_Prelude.Apply_0"]()))(f))(Prelude.pure(__dict_Applicative_96)(Prelude.unit));
            };
        };
    };
    var for_ = function (__dict_Applicative_98) {
        return function (__dict_Foldable_99) {
            return Prelude.flip(traverse_(__dict_Applicative_98)(__dict_Foldable_99));
        };
    };
    var foldl = function (dict) {
        return dict.foldl;
    };
    var mconcat = function (__dict_Foldable_104) {
        return function (__dict_Monoid_105) {
            return foldl(__dict_Foldable_104)(Prelude["<>"](__dict_Monoid_105["__superclass_Prelude.Semigroup_0"]()))(Data_Monoid.mempty(__dict_Monoid_105));
        };
    };
    var foldableArray = new Foldable(function (__dict_Monoid_113) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_113["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_113))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    return {
        Foldable: Foldable, 
        foldableArray: foldableArray, 
        foldl: foldl, 
        foldlArray: foldlArray, 
        foldr: foldr, 
        foldrArray: foldrArray, 
        for_: for_, 
        mconcat: mconcat, 
        traverse_: traverse_
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Element = (function () {
    "use strict";
    var Data_DOM_Simple_Unsafe_Element = PS.Data_DOM_Simple_Unsafe_Element;
    var Data_DOM_Simple_Unsafe_Utils = PS.Data_DOM_Simple_Unsafe_Utils;
    var Prelude = PS.Prelude;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Tuple = PS.Data_Tuple;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    function Element(children, classAdd, classContains, classRemove, classToggle, contentWindow, getAttribute, getElementById, getElementsByClassName, getElementsByName, hasAttribute, innerHTML, querySelector, querySelectorAll, removeAttribute, setAttribute, setInnerHTML, setTextContent, setValue, textContent, value) {
        this.children = children;
        this.classAdd = classAdd;
        this.classContains = classContains;
        this.classRemove = classRemove;
        this.classToggle = classToggle;
        this.contentWindow = contentWindow;
        this.getAttribute = getAttribute;
        this.getElementById = getElementById;
        this.getElementsByClassName = getElementsByClassName;
        this.getElementsByName = getElementsByName;
        this.hasAttribute = hasAttribute;
        this.innerHTML = innerHTML;
        this.querySelector = querySelector;
        this.querySelectorAll = querySelectorAll;
        this.removeAttribute = removeAttribute;
        this.setAttribute = setAttribute;
        this.setInnerHTML = setInnerHTML;
        this.setTextContent = setTextContent;
        this.setValue = setValue;
        this.textContent = textContent;
        this.value = value;
    };
    var value = function (dict) {
        return dict.value;
    };
    var setInnerHTML = function (dict) {
        return dict.setInnerHTML;
    };
    var querySelector = function (dict) {
        return dict.querySelector;
    };
    var htmlElement = new Element(Data_DOM_Simple_Unsafe_Element.unsafeChildren, Data_DOM_Simple_Unsafe_Element.unsafeClassAdd, Data_DOM_Simple_Unsafe_Element.unsafeClassContains, Data_DOM_Simple_Unsafe_Element.unsafeClassRemove, Data_DOM_Simple_Unsafe_Element.unsafeClassToggle, Data_DOM_Simple_Unsafe_Element.unsafeContentWindow, Data_DOM_Simple_Unsafe_Element.unsafeGetAttribute, function (id) {
        return function (el) {
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Unsafe_Element.unsafeGetElementById(id)(el))(Prelude[">>>"](Prelude.semigroupoidArr)(Data_DOM_Simple_Unsafe_Utils.ensure)(Prelude["return"](Control_Monad_Eff.monadEff)));
        };
    }, Data_DOM_Simple_Unsafe_Element.unsafeGetElementsByClassName, Data_DOM_Simple_Unsafe_Element.unsafeGetElementsByName, Data_DOM_Simple_Unsafe_Element.unsafeHasAttribute, Data_DOM_Simple_Unsafe_Element.unsafeInnerHTML, function (sel) {
        return function (el) {
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Unsafe_Element.unsafeQuerySelector(sel)(el))(Prelude[">>>"](Prelude.semigroupoidArr)(Data_DOM_Simple_Unsafe_Utils.ensure)(Prelude["return"](Control_Monad_Eff.monadEff)));
        };
    }, Data_DOM_Simple_Unsafe_Element.unsafeQuerySelectorAll, Data_DOM_Simple_Unsafe_Element.unsafeRemoveAttribute, Data_DOM_Simple_Unsafe_Element.unsafeSetAttribute, Data_DOM_Simple_Unsafe_Element.unsafeSetInnerHTML, Data_DOM_Simple_Unsafe_Element.unsafeSetTextContent, Data_DOM_Simple_Unsafe_Element.unsafeSetValue, Data_DOM_Simple_Unsafe_Element.unsafeTextContent, Data_DOM_Simple_Unsafe_Element.unsafeValue);
    return {
        Element: Element, 
        htmlElement: htmlElement, 
        querySelector: querySelector, 
        setInnerHTML: setInnerHTML, 
        value: value
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Document = (function () {
    "use strict";
    var Data_DOM_Simple_Unsafe_Element = PS.Data_DOM_Simple_Unsafe_Element;
    var Prelude = PS.Prelude;
    var Data_DOM_Simple_Unsafe_Utils = PS.Data_DOM_Simple_Unsafe_Utils;
    var Data_DOM_Simple_Unsafe_Document = PS.Data_DOM_Simple_Unsafe_Document;
    var Data_DOM_Simple_Element = PS.Data_DOM_Simple_Element;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var htmlDocumentElement = new Data_DOM_Simple_Element.Element(Data_DOM_Simple_Unsafe_Element.unsafeChildren, Data_DOM_Simple_Unsafe_Element.unsafeClassAdd, Data_DOM_Simple_Unsafe_Element.unsafeClassContains, Data_DOM_Simple_Unsafe_Element.unsafeClassRemove, Data_DOM_Simple_Unsafe_Element.unsafeClassToggle, Data_DOM_Simple_Unsafe_Element.unsafeContentWindow, Data_DOM_Simple_Unsafe_Element.unsafeGetAttribute, function (id) {
        return function (el) {
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Unsafe_Element.unsafeGetElementById(id)(el))(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude["return"](Control_Monad_Eff.monadEff))(Data_DOM_Simple_Unsafe_Utils.ensure));
        };
    }, Data_DOM_Simple_Unsafe_Element.unsafeGetElementsByClassName, Data_DOM_Simple_Unsafe_Element.unsafeGetElementsByName, Data_DOM_Simple_Unsafe_Element.unsafeHasAttribute, Data_DOM_Simple_Unsafe_Element.unsafeInnerHTML, function (sel) {
        return function (el) {
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Unsafe_Element.unsafeQuerySelector(sel)(el))(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude["return"](Control_Monad_Eff.monadEff))(Data_DOM_Simple_Unsafe_Utils.ensure));
        };
    }, Data_DOM_Simple_Unsafe_Element.unsafeQuerySelectorAll, Data_DOM_Simple_Unsafe_Element.unsafeRemoveAttribute, Data_DOM_Simple_Unsafe_Element.unsafeSetAttribute, Data_DOM_Simple_Unsafe_Element.unsafeSetInnerHTML, Data_DOM_Simple_Unsafe_Element.unsafeSetTextContent, Data_DOM_Simple_Unsafe_Element.unsafeSetValue, Data_DOM_Simple_Unsafe_Element.unsafeTextContent, Data_DOM_Simple_Unsafe_Element.unsafeValue);
    return {
        htmlDocumentElement: htmlDocumentElement
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Char = PS.Data_Char;
    var Prelude = PS.Prelude;
    
    function joinWith(s) {
      return function(xs) {
        return xs.join(s);
      };
    }
    ;
    return {
        joinWith: joinWith
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Window = (function () {
    "use strict";
    var Data_DOM_Simple_Unsafe_Window = PS.Data_DOM_Simple_Unsafe_Window;
    var Data_String = PS.Data_String;
    var Data_Array = PS.Data_Array;
    var Prelude = PS.Prelude;
    function Window(clearTimeout, document, innerHeight, innerWidth, location, setInterval, setTimeout) {
        this.clearTimeout = clearTimeout;
        this.document = document;
        this.innerHeight = innerHeight;
        this.innerWidth = innerWidth;
        this.location = location;
        this.setInterval = setInterval;
        this.setTimeout = setTimeout;
    };
    var globalWindow = window;;
    var htmlWindow = new Window(Data_DOM_Simple_Unsafe_Window.unsafeClearTimeout, Data_DOM_Simple_Unsafe_Window.unsafeDocument, Data_DOM_Simple_Unsafe_Window.unsafeInnerHeight, Data_DOM_Simple_Unsafe_Window.unsafeInnerWidth, Data_DOM_Simple_Unsafe_Window.unsafeLocation, Data_DOM_Simple_Unsafe_Window.unsafeSetInterval, Data_DOM_Simple_Unsafe_Window.unsafeSetTimeout);
    var document = function (dict) {
        return dict.document;
    };
    return {
        Window: Window, 
        document: document, 
        globalWindow: globalWindow, 
        htmlWindow: htmlWindow
    };
})();
var PS = PS || {};
PS.Data_DOM_Simple_Events = (function () {
    "use strict";
    var Data_DOM_Simple_Unsafe_Events = PS.Data_DOM_Simple_Unsafe_Events;
    var Prelude = PS.Prelude;
    function LoadEvent() {

    };
    LoadEvent.value = new LoadEvent();
    function UnloadEvent() {

    };
    UnloadEvent.value = new UnloadEvent();
    function AbortEvent() {

    };
    AbortEvent.value = new AbortEvent();
    function ErrorEvent() {

    };
    ErrorEvent.value = new ErrorEvent();
    function SelectEvent() {

    };
    SelectEvent.value = new SelectEvent();
    function ResizeEvent() {

    };
    ResizeEvent.value = new ResizeEvent();
    function ScrollEvent() {

    };
    ScrollEvent.value = new ScrollEvent();
    function Event(eventTarget, preventDefault, stopPropagation) {
        this.eventTarget = eventTarget;
        this.preventDefault = preventDefault;
        this.stopPropagation = stopPropagation;
    };
    function UIEvent(__superclass_Data$dotDOM$dotSimple$dotEvents$dotEvent_0, detail, view) {
        this["__superclass_Data.DOM.Simple.Events.Event_0"] = __superclass_Data$dotDOM$dotSimple$dotEvents$dotEvent_0;
        this.detail = detail;
        this.view = view;
    };
    function UIEventTarget(addUIEventListener, removeUIEventListener) {
        this.addUIEventListener = addUIEventListener;
        this.removeUIEventListener = removeUIEventListener;
    };
    var uiEventTypeShow = new Prelude.Show(function (_298) {
        if (_298 instanceof LoadEvent) {
            return "load";
        };
        if (_298 instanceof UnloadEvent) {
            return "unload";
        };
        if (_298 instanceof AbortEvent) {
            return "abort";
        };
        if (_298 instanceof ErrorEvent) {
            return "error";
        };
        if (_298 instanceof SelectEvent) {
            return "select";
        };
        if (_298 instanceof ResizeEvent) {
            return "resize";
        };
        if (_298 instanceof ScrollEvent) {
            return "scroll";
        };
        throw new Error("Failed pattern match");
    });
    var uiEventTargetHTMLWindow = new UIEventTarget(function (__dict_UIEvent_133) {
        return function (typ) {
            return Data_DOM_Simple_Unsafe_Events.unsafeAddEventListener(Prelude.show(uiEventTypeShow)(typ));
        };
    }, function (__dict_UIEvent_134) {
        return function (typ) {
            return Data_DOM_Simple_Unsafe_Events.unsafeRemoveEventListener(Prelude.show(uiEventTypeShow)(typ));
        };
    });
    var eventDOMEvent = new Event(Data_DOM_Simple_Unsafe_Events.unsafeEventTarget, Data_DOM_Simple_Unsafe_Events.unsafePreventDefault, Data_DOM_Simple_Unsafe_Events.unsafeStopPropagation);
    var uiEventDOMEvent = new UIEvent(function () {
        return eventDOMEvent;
    }, Data_DOM_Simple_Unsafe_Events.unsafeEventNumberProp("detail"), Data_DOM_Simple_Unsafe_Events.unsafeEventView);
    var addUIEventListener = function (dict) {
        return dict.addUIEventListener;
    };
    return {
        AbortEvent: AbortEvent, 
        ErrorEvent: ErrorEvent, 
        Event: Event, 
        LoadEvent: LoadEvent, 
        ResizeEvent: ResizeEvent, 
        ScrollEvent: ScrollEvent, 
        SelectEvent: SelectEvent, 
        UIEvent: UIEvent, 
        UIEventTarget: UIEventTarget, 
        UnloadEvent: UnloadEvent, 
        addUIEventListener: addUIEventListener, 
        eventDOMEvent: eventDOMEvent, 
        uiEventDOMEvent: uiEventDOMEvent, 
        uiEventTargetHTMLWindow: uiEventTargetHTMLWindow, 
        uiEventTypeShow: uiEventTypeShow
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Foldable = PS.Data_Foldable;
    function Traversable(__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_156) {
        return function (_302) {
            if (_302.length === 0) {
                return Prelude.pure(__dict_Applicative_156)([  ]);
            };
            if (_302.length >= 1) {
                var _444 = _302.slice(1);
                return Prelude["<*>"](__dict_Applicative_156["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_156["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_302[0]))(sequence(traversableArray)(__dict_Applicative_156)(_444));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_155) {
        return function (_300) {
            return function (_301) {
                if (_301.length === 0) {
                    return Prelude.pure(__dict_Applicative_155)([  ]);
                };
                if (_301.length >= 1) {
                    var _448 = _301.slice(1);
                    return Prelude["<*>"](__dict_Applicative_155["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_155["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_300(_301[0])))(traverse(traversableArray)(__dict_Applicative_155)(_300)(_448));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    return {
        Traversable: Traversable, 
        sequence: sequence, 
        traversableArray: traversableArray, 
        traverse: traverse
    };
})();
var PS = PS || {};
PS.Data_Map = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    function Leaf() {

    };
    Leaf.value = new Leaf();
    function Two(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    Two.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new Two(value0, value1, value2, value3);
                };
            };
        };
    };
    function Three(value0, value1, value2, value3, value4, value5, value6) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
        this.value4 = value4;
        this.value5 = value5;
        this.value6 = value6;
    };
    Three.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return function (value4) {
                        return function (value5) {
                            return function (value6) {
                                return new Three(value0, value1, value2, value3, value4, value5, value6);
                            };
                        };
                    };
                };
            };
        };
    };
    function TwoLeft(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    TwoLeft.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new TwoLeft(value0, value1, value2);
            };
        };
    };
    function TwoRight(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    TwoRight.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new TwoRight(value0, value1, value2);
            };
        };
    };
    function ThreeLeft(value0, value1, value2, value3, value4, value5) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
        this.value4 = value4;
        this.value5 = value5;
    };
    ThreeLeft.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return function (value4) {
                        return function (value5) {
                            return new ThreeLeft(value0, value1, value2, value3, value4, value5);
                        };
                    };
                };
            };
        };
    };
    function ThreeMiddle(value0, value1, value2, value3, value4, value5) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
        this.value4 = value4;
        this.value5 = value5;
    };
    ThreeMiddle.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return function (value4) {
                        return function (value5) {
                            return new ThreeMiddle(value0, value1, value2, value3, value4, value5);
                        };
                    };
                };
            };
        };
    };
    function ThreeRight(value0, value1, value2, value3, value4, value5) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
        this.value4 = value4;
        this.value5 = value5;
    };
    ThreeRight.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return function (value4) {
                        return function (value5) {
                            return new ThreeRight(value0, value1, value2, value3, value4, value5);
                        };
                    };
                };
            };
        };
    };
    function KickUp(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    KickUp.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new KickUp(value0, value1, value2, value3);
                };
            };
        };
    };
    var toList = function (_323) {
        if (_323 instanceof Leaf) {
            return [  ];
        };
        if (_323 instanceof Two) {
            return Prelude["++"](Data_Array.semigroupArray)(toList(_323.value0))(Prelude["++"](Data_Array.semigroupArray)([ new Data_Tuple.Tuple(_323.value1, _323.value2) ])(toList(_323.value3)));
        };
        if (_323 instanceof Three) {
            return Prelude["++"](Data_Array.semigroupArray)(toList(_323.value0))(Prelude["++"](Data_Array.semigroupArray)([ new Data_Tuple.Tuple(_323.value1, _323.value2) ])(Prelude["++"](Data_Array.semigroupArray)(toList(_323.value3))(Prelude["++"](Data_Array.semigroupArray)([ new Data_Tuple.Tuple(_323.value4, _323.value5) ])(toList(_323.value6)))));
        };
        throw new Error("Failed pattern match");
    };
    var lookup = function (__copy___dict_Ord_164) {
        return function (__copy__319) {
            return function (__copy__320) {
                var __dict_Ord_164 = __copy___dict_Ord_164;
                var _319 = __copy__319;
                var _320 = __copy__320;
                tco: while (true) {
                    if (_320 instanceof Leaf) {
                        return Data_Maybe.Nothing.value;
                    };
                    if (_320 instanceof Two && Prelude["=="](__dict_Ord_164["__superclass_Prelude.Eq_0"]())(_319)(_320.value1)) {
                        return new Data_Maybe.Just(_320.value2);
                    };
                    if (_320 instanceof Two && Prelude["<"](__dict_Ord_164)(_319)(_320.value1)) {
                        var __tco___dict_Ord_164 = __dict_Ord_164;
                        var __tco__319 = _319;
                        var __tco__320 = _320.value0;
                        __dict_Ord_164 = __tco___dict_Ord_164;
                        _319 = __tco__319;
                        _320 = __tco__320;
                        continue tco;
                    };
                    if (_320 instanceof Two) {
                        var __tco___dict_Ord_164 = __dict_Ord_164;
                        var __tco__319 = _319;
                        var __tco__320 = _320.value3;
                        __dict_Ord_164 = __tco___dict_Ord_164;
                        _319 = __tco__319;
                        _320 = __tco__320;
                        continue tco;
                    };
                    if (_320 instanceof Three && Prelude["=="](__dict_Ord_164["__superclass_Prelude.Eq_0"]())(_319)(_320.value1)) {
                        return new Data_Maybe.Just(_320.value2);
                    };
                    if (_320 instanceof Three && Prelude["=="](__dict_Ord_164["__superclass_Prelude.Eq_0"]())(_319)(_320.value4)) {
                        return new Data_Maybe.Just(_320.value5);
                    };
                    if (_320 instanceof Three && Prelude["<"](__dict_Ord_164)(_319)(_320.value1)) {
                        var __tco___dict_Ord_164 = __dict_Ord_164;
                        var __tco__319 = _319;
                        var __tco__320 = _320.value0;
                        __dict_Ord_164 = __tco___dict_Ord_164;
                        _319 = __tco__319;
                        _320 = __tco__320;
                        continue tco;
                    };
                    if (_320 instanceof Three && (Prelude["<"](__dict_Ord_164)(_320.value1)(_319) && Prelude["<="](__dict_Ord_164)(_319)(_320.value4))) {
                        var __tco___dict_Ord_164 = __dict_Ord_164;
                        var __tco__319 = _319;
                        var __tco__320 = _320.value3;
                        __dict_Ord_164 = __tco___dict_Ord_164;
                        _319 = __tco__319;
                        _320 = __tco__320;
                        continue tco;
                    };
                    if (_320 instanceof Three) {
                        var __tco___dict_Ord_164 = __dict_Ord_164;
                        var __tco__319 = _319;
                        var __tco__320 = _320.value6;
                        __dict_Ord_164 = __tco___dict_Ord_164;
                        _319 = __tco__319;
                        _320 = __tco__320;
                        continue tco;
                    };
                    throw new Error("Failed pattern match");
                };
            };
        };
    };
    var keys = function (_324) {
        if (_324 instanceof Leaf) {
            return [  ];
        };
        if (_324 instanceof Two) {
            return Prelude["++"](Data_Array.semigroupArray)(keys(_324.value0))(Prelude["++"](Data_Array.semigroupArray)([ _324.value1 ])(keys(_324.value3)));
        };
        if (_324 instanceof Three) {
            return Prelude["++"](Data_Array.semigroupArray)(keys(_324.value0))(Prelude["++"](Data_Array.semigroupArray)([ _324.value1 ])(Prelude["++"](Data_Array.semigroupArray)(keys(_324.value3))(Prelude["++"](Data_Array.semigroupArray)([ _324.value4 ])(keys(_324.value6)))));
        };
        throw new Error("Failed pattern match");
    };
    var fromZipper = function (__copy___dict_Ord_166) {
        return function (__copy__321) {
            return function (__copy__322) {
                var __dict_Ord_166 = __copy___dict_Ord_166;
                var _321 = __copy__321;
                var _322 = __copy__322;
                tco: while (true) {
                    if (_321.length === 0) {
                        return _322;
                    };
                    if (_321.length >= 1) {
                        var _528 = _321.slice(1);
                        if (_321[0] instanceof TwoLeft) {
                            var __tco___dict_Ord_166 = __dict_Ord_166;
                            var __tco__322 = new Two(_322, (_321[0]).value0, (_321[0]).value1, (_321[0]).value2);
                            __dict_Ord_166 = __tco___dict_Ord_166;
                            _321 = _528;
                            _322 = __tco__322;
                            continue tco;
                        };
                    };
                    if (_321.length >= 1) {
                        var _533 = _321.slice(1);
                        if (_321[0] instanceof TwoRight) {
                            var __tco___dict_Ord_166 = __dict_Ord_166;
                            var __tco__322 = new Two((_321[0]).value0, (_321[0]).value1, (_321[0]).value2, _322);
                            __dict_Ord_166 = __tco___dict_Ord_166;
                            _321 = _533;
                            _322 = __tco__322;
                            continue tco;
                        };
                    };
                    if (_321.length >= 1) {
                        var _541 = _321.slice(1);
                        if (_321[0] instanceof ThreeLeft) {
                            var __tco___dict_Ord_166 = __dict_Ord_166;
                            var __tco__322 = new Three(_322, (_321[0]).value0, (_321[0]).value1, (_321[0]).value2, (_321[0]).value3, (_321[0]).value4, (_321[0]).value5);
                            __dict_Ord_166 = __tco___dict_Ord_166;
                            _321 = _541;
                            _322 = __tco__322;
                            continue tco;
                        };
                    };
                    if (_321.length >= 1) {
                        var _549 = _321.slice(1);
                        if (_321[0] instanceof ThreeMiddle) {
                            var __tco___dict_Ord_166 = __dict_Ord_166;
                            var __tco__322 = new Three((_321[0]).value0, (_321[0]).value1, (_321[0]).value2, _322, (_321[0]).value3, (_321[0]).value4, (_321[0]).value5);
                            __dict_Ord_166 = __tco___dict_Ord_166;
                            _321 = _549;
                            _322 = __tco__322;
                            continue tco;
                        };
                    };
                    if (_321.length >= 1) {
                        var _557 = _321.slice(1);
                        if (_321[0] instanceof ThreeRight) {
                            var __tco___dict_Ord_166 = __dict_Ord_166;
                            var __tco__322 = new Three((_321[0]).value0, (_321[0]).value1, (_321[0]).value2, (_321[0]).value3, (_321[0]).value4, (_321[0]).value5, _322);
                            __dict_Ord_166 = __tco___dict_Ord_166;
                            _321 = _557;
                            _322 = __tco__322;
                            continue tco;
                        };
                    };
                    throw new Error("Failed pattern match");
                };
            };
        };
    };
    var insert = function (__dict_Ord_167) {
        var up = function (__copy___dict_Ord_168) {
            return function (__copy__333) {
                return function (__copy__334) {
                    var __dict_Ord_168 = __copy___dict_Ord_168;
                    var _333 = __copy__333;
                    var _334 = __copy__334;
                    tco: while (true) {
                        if (_333.length === 0) {
                            return new Two(_334.value0, _334.value1, _334.value2, _334.value3);
                        };
                        if (_333.length >= 1) {
                            var _572 = _333.slice(1);
                            if (_333[0] instanceof TwoLeft) {
                                return fromZipper(__dict_Ord_168)(_572)(new Three(_334.value0, _334.value1, _334.value2, _334.value3, (_333[0]).value0, (_333[0]).value1, (_333[0]).value2));
                            };
                        };
                        if (_333.length >= 1) {
                            var _581 = _333.slice(1);
                            if (_333[0] instanceof TwoRight) {
                                return fromZipper(__dict_Ord_168)(_581)(new Three((_333[0]).value0, (_333[0]).value1, (_333[0]).value2, _334.value0, _334.value1, _334.value2, _334.value3));
                            };
                        };
                        if (_333.length >= 1) {
                            var _593 = _333.slice(1);
                            if (_333[0] instanceof ThreeLeft) {
                                var __tco___dict_Ord_168 = __dict_Ord_168;
                                var __tco__334 = new KickUp(new Two(_334.value0, _334.value1, _334.value2, _334.value3), (_333[0]).value0, (_333[0]).value1, new Two((_333[0]).value2, (_333[0]).value3, (_333[0]).value4, (_333[0]).value5));
                                __dict_Ord_168 = __tco___dict_Ord_168;
                                _333 = _593;
                                _334 = __tco__334;
                                continue tco;
                            };
                        };
                        if (_333.length >= 1) {
                            var _605 = _333.slice(1);
                            if (_333[0] instanceof ThreeMiddle) {
                                var __tco___dict_Ord_168 = __dict_Ord_168;
                                var __tco__334 = new KickUp(new Two((_333[0]).value0, (_333[0]).value1, (_333[0]).value2, _334.value0), _334.value1, _334.value2, new Two(_334.value3, (_333[0]).value3, (_333[0]).value4, (_333[0]).value5));
                                __dict_Ord_168 = __tco___dict_Ord_168;
                                _333 = _605;
                                _334 = __tco__334;
                                continue tco;
                            };
                        };
                        if (_333.length >= 1) {
                            var _617 = _333.slice(1);
                            if (_333[0] instanceof ThreeRight) {
                                var __tco___dict_Ord_168 = __dict_Ord_168;
                                var __tco__334 = new KickUp(new Two((_333[0]).value0, (_333[0]).value1, (_333[0]).value2, (_333[0]).value3), (_333[0]).value4, (_333[0]).value5, new Two(_334.value0, _334.value1, _334.value2, _334.value3));
                                __dict_Ord_168 = __tco___dict_Ord_168;
                                _333 = _617;
                                _334 = __tco__334;
                                continue tco;
                            };
                        };
                        throw new Error("Failed pattern match");
                    };
                };
            };
        };
        var down = function (__copy___dict_Ord_169) {
            return function (__copy__329) {
                return function (__copy__330) {
                    return function (__copy__331) {
                        return function (__copy__332) {
                            var __dict_Ord_169 = __copy___dict_Ord_169;
                            var _329 = __copy__329;
                            var _330 = __copy__330;
                            var _331 = __copy__331;
                            var _332 = __copy__332;
                            tco: while (true) {
                                if (_332 instanceof Leaf) {
                                    return up(__dict_Ord_169)(_329)(new KickUp(Leaf.value, _330, _331, Leaf.value));
                                };
                                if (_332 instanceof Two && Prelude["=="](__dict_Ord_169["__superclass_Prelude.Eq_0"]())(_330)(_332.value1)) {
                                    return fromZipper(__dict_Ord_169)(_329)(new Two(_332.value0, _330, _331, _332.value3));
                                };
                                if (_332 instanceof Two && Prelude["<"](__dict_Ord_169)(_330)(_332.value1)) {
                                    var __tco___dict_Ord_169 = __dict_Ord_169;
                                    var __tco__329 = Prelude[":"](new TwoLeft(_332.value1, _332.value2, _332.value3))(_329);
                                    var __tco__330 = _330;
                                    var __tco__331 = _331;
                                    var __tco__332 = _332.value0;
                                    __dict_Ord_169 = __tco___dict_Ord_169;
                                    _329 = __tco__329;
                                    _330 = __tco__330;
                                    _331 = __tco__331;
                                    _332 = __tco__332;
                                    continue tco;
                                };
                                if (_332 instanceof Two) {
                                    var __tco___dict_Ord_169 = __dict_Ord_169;
                                    var __tco__329 = Prelude[":"](new TwoRight(_332.value0, _332.value1, _332.value2))(_329);
                                    var __tco__330 = _330;
                                    var __tco__331 = _331;
                                    var __tco__332 = _332.value3;
                                    __dict_Ord_169 = __tco___dict_Ord_169;
                                    _329 = __tco__329;
                                    _330 = __tco__330;
                                    _331 = __tco__331;
                                    _332 = __tco__332;
                                    continue tco;
                                };
                                if (_332 instanceof Three && Prelude["=="](__dict_Ord_169["__superclass_Prelude.Eq_0"]())(_330)(_332.value1)) {
                                    return fromZipper(__dict_Ord_169)(_329)(new Three(_332.value0, _330, _331, _332.value3, _332.value4, _332.value5, _332.value6));
                                };
                                if (_332 instanceof Three && Prelude["=="](__dict_Ord_169["__superclass_Prelude.Eq_0"]())(_330)(_332.value4)) {
                                    return fromZipper(__dict_Ord_169)(_329)(new Three(_332.value0, _332.value1, _332.value2, _332.value3, _330, _331, _332.value6));
                                };
                                if (_332 instanceof Three && Prelude["<"](__dict_Ord_169)(_330)(_332.value1)) {
                                    var __tco___dict_Ord_169 = __dict_Ord_169;
                                    var __tco__329 = Prelude[":"](new ThreeLeft(_332.value1, _332.value2, _332.value3, _332.value4, _332.value5, _332.value6))(_329);
                                    var __tco__330 = _330;
                                    var __tco__331 = _331;
                                    var __tco__332 = _332.value0;
                                    __dict_Ord_169 = __tco___dict_Ord_169;
                                    _329 = __tco__329;
                                    _330 = __tco__330;
                                    _331 = __tco__331;
                                    _332 = __tco__332;
                                    continue tco;
                                };
                                if (_332 instanceof Three && (Prelude["<"](__dict_Ord_169)(_332.value1)(_330) && Prelude["<="](__dict_Ord_169)(_330)(_332.value4))) {
                                    var __tco___dict_Ord_169 = __dict_Ord_169;
                                    var __tco__329 = Prelude[":"](new ThreeMiddle(_332.value0, _332.value1, _332.value2, _332.value4, _332.value5, _332.value6))(_329);
                                    var __tco__330 = _330;
                                    var __tco__331 = _331;
                                    var __tco__332 = _332.value3;
                                    __dict_Ord_169 = __tco___dict_Ord_169;
                                    _329 = __tco__329;
                                    _330 = __tco__330;
                                    _331 = __tco__331;
                                    _332 = __tco__332;
                                    continue tco;
                                };
                                if (_332 instanceof Three) {
                                    var __tco___dict_Ord_169 = __dict_Ord_169;
                                    var __tco__329 = Prelude[":"](new ThreeRight(_332.value0, _332.value1, _332.value2, _332.value3, _332.value4, _332.value5))(_329);
                                    var __tco__330 = _330;
                                    var __tco__331 = _331;
                                    var __tco__332 = _332.value6;
                                    __dict_Ord_169 = __tco___dict_Ord_169;
                                    _329 = __tco__329;
                                    _330 = __tco__330;
                                    _331 = __tco__331;
                                    _332 = __tco__332;
                                    continue tco;
                                };
                                throw new Error("Failed pattern match");
                            };
                        };
                    };
                };
            };
        };
        return down(__dict_Ord_167)([  ]);
    };
    var empty = Leaf.value;
    var fromList = function (__dict_Ord_174) {
        return Data_Foldable.foldl(Data_Foldable.foldableArray)(function (m) {
            return function (_315) {
                return insert(__dict_Ord_174)(_315.value0)(_315.value1)(m);
            };
        })(empty);
    };
    return {
        empty: empty, 
        fromList: fromList, 
        insert: insert, 
        keys: keys, 
        lookup: lookup, 
        toList: toList
    };
})();
var PS = PS || {};
PS.Data_JSON = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Map = PS.Data_Map;
    var Data_Set = PS.Data_Set;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Function = PS.Data_Function;
    var Data_Either = PS.Data_Either;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Array = PS.Data_Array;
    function JObject(value0) {
        this.value0 = value0;
    };
    JObject.create = function (value0) {
        return new JObject(value0);
    };
    function JArray(value0) {
        this.value0 = value0;
    };
    JArray.create = function (value0) {
        return new JArray(value0);
    };
    function JString(value0) {
        this.value0 = value0;
    };
    JString.create = function (value0) {
        return new JString(value0);
    };
    function JNumber(value0) {
        this.value0 = value0;
    };
    JNumber.create = function (value0) {
        return new JNumber(value0);
    };
    function JBool(value0) {
        this.value0 = value0;
    };
    JBool.create = function (value0) {
        return new JBool(value0);
    };
    function JNull() {

    };
    JNull.value = new JNull();
    function FromJSON(parseJSON) {
        this.parseJSON = parseJSON;
    };
    function ToJSON(toJSON) {
        this.toJSON = toJSON;
    };
    function jsonParseImpl (left, right, string) {    try       { return right(JSON.parse(string)); }    catch (e) { return left(e.toString()); }};
    function jsonToValueImpl (auxes, ctors) {    var left   = auxes.left;    var right  = auxes.right;    var either = auxes.either;    var insert = auxes.insert;    var empty  = auxes.empty;    var Null   = ctors.null;    var Number = ctors.number;    var Bool   = ctors.bool;    var String = ctors.string;    var Array  = ctors.array;    var Object = ctors.object;    var parse  = function(json) {        var typ    = Object.prototype.toString.call(json).slice(8,-1);         if        (typ === 'Number') {             return right(Number(json));        } else if (typ === 'Boolean') {             return right(Bool(json));        } else if (typ === 'String') {             return right(String(json));        } else if (typ === 'Null') {             return right(Null);        } else if (typ === 'Array') {             var ary = [];            for(var i = 0; i < json.length; i++) {                 either                     (function(l){return left(l)})                     (function(r){ary.push(r)})                     (parse(json[i]))             }             return right(Array(ary));        } else if (typ === 'Object') {            var obj = empty;            for(var k in json) {                 either                     (function(l){return left(l)})                     (function(r){obj = insert(k)(r)(obj)})                     (parse(json[k]));            }             return right(Object(obj));        } else {             return left('unknown type: ' + typ);        }   };   return parse;};
    var jsNull = null;
    function unsafeCoerce (a) {return a;};
    function objToHash (fst, snd, obj) {    var hash = {};    for(var i = 0; i < obj.length; i++) {        hash[fst(obj[i])] = valueToJSONImpl(snd(obj[i]));    }    return hash;};
    function jsonStringify(json) {    return JSON.stringify(json);};
    var valueToJSONImpl = function (_359) {
        if (_359 instanceof JObject) {
            return objToHash(Data_Tuple.fst, Data_Tuple.snd, Data_Map.toList(_359.value0));
        };
        if (_359 instanceof JArray) {
            return unsafeCoerce(Prelude["<$>"](Data_Array.functorArray)(valueToJSONImpl)(_359.value0));
        };
        if (_359 instanceof JString) {
            return unsafeCoerce(_359.value0);
        };
        if (_359 instanceof JNumber) {
            return unsafeCoerce(_359.value0);
        };
        if (_359 instanceof JBool) {
            return unsafeCoerce(_359.value0);
        };
        if (_359 instanceof JNull) {
            return jsNull;
        };
        throw new Error("Failed pattern match");
    };
    var valueToString = function (v) {
        return jsonStringify(valueToJSONImpl(v));
    };
    var toJSON = function (dict) {
        return dict.toJSON;
    };
    var stringToJSON = new ToJSON(JString.create);
    var parseJSON = function (dict) {
        return dict.parseJSON;
    };
    var jsonToValue = (function () {
        var insert$prime = Data_Map.insert(Prelude.ordString);
        var ctors = {
            "null": JNull.value, 
            number: JNumber.create, 
            bool: JBool.create, 
            string: JString.create, 
            array: JArray.create, 
            object: JObject.create
        };
        var auxes = {
            left: Data_Either.Left.create, 
            right: Data_Either.Right.create, 
            either: Data_Either.either, 
            insert: insert$prime, 
            empty: Data_Map.empty
        };
        return Data_Function.runFn3(jsonParseImpl)(Data_Either.Left.create)(jsonToValueImpl(auxes, ctors));
    })();
    var fail = Data_Either.Left.create;
    var encode = function (__dict_ToJSON_210) {
        return function (a) {
            return valueToString(toJSON(__dict_ToJSON_210)(a));
        };
    };
    var eitherDecode = function (__dict_FromJSON_215) {
        return function (s) {
            return Prelude[">>="](Data_Either.bindEither)(jsonToValue(s))(function (_8) {
                return parseJSON(__dict_FromJSON_215)(_8);
            });
        };
    };
    var decode = function (__dict_FromJSON_216) {
        return function (s) {
            var _679 = eitherDecode(__dict_FromJSON_216)(s);
            if (_679 instanceof Data_Either.Right) {
                return new Data_Maybe.Just(_679.value0);
            };
            if (_679 instanceof Data_Either.Left) {
                return Data_Maybe.Nothing.value;
            };
            throw new Error("Failed pattern match");
        };
    };
    return {
        FromJSON: FromJSON, 
        JArray: JArray, 
        JBool: JBool, 
        JNull: JNull, 
        JNumber: JNumber, 
        JObject: JObject, 
        JString: JString, 
        ToJSON: ToJSON, 
        decode: decode, 
        eitherDecode: eitherDecode, 
        encode: encode, 
        fail: fail, 
        parseJSON: parseJSON, 
        stringToJSON: stringToJSON, 
        toJSON: toJSON
    };
})();
var PS = PS || {};
PS.Text_Smolder_Renderer_Util = (function () {
    "use strict";
    var Data_Map = PS.Data_Map;
    var Prelude = PS.Prelude;
    var Text_Smolder_Markup = PS.Text_Smolder_Markup;
    var Data_Array = PS.Data_Array;
    function Element(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    Element.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new Element(value0, value1, value2);
            };
        };
    };
    function Text(value0) {
        this.value0 = value0;
    };
    Text.create = function (value0) {
        return new Text(value0);
    };
    var renderMarkup = function (_376) {
        if (_376 instanceof Text_Smolder_Markup.Parent) {
            return [ Element.create(_376.value0)(Data_Map.empty)(renderMarkup(_376.value1)) ];
        };
        if (_376 instanceof Text_Smolder_Markup.Leaf) {
            return [ new Element(_376.value0, Data_Map.empty, [  ]) ];
        };
        if (_376 instanceof Text_Smolder_Markup.Content) {
            return [ new Text(_376.value0) ];
        };
        if (_376 instanceof Text_Smolder_Markup.Append) {
            return Prelude["++"](Data_Array.semigroupArray)(renderMarkup(_376.value0))(renderMarkup(_376.value1));
        };
        if (_376 instanceof Text_Smolder_Markup.AddAttribute) {
            var _689 = renderMarkup(_376.value2);
            if (_689.length >= 1) {
                var _694 = _689.slice(1);
                if (_689[0] instanceof Element) {
                    return Prelude["++"](Data_Array.semigroupArray)([ new Element((_689[0]).value0, Data_Map.insert(Prelude.ordString)(_376.value0)(_376.value1)((_689[0]).value1), (_689[0]).value2) ])(_694);
                };
            };
            throw new Error("Failed pattern match");
        };
        if (_376 instanceof Text_Smolder_Markup.Empty) {
            return [  ];
        };
        throw new Error("Failed pattern match");
    };
    return {
        Element: Element, 
        Text: Text, 
        renderMarkup: renderMarkup
    };
})();
var PS = PS || {};
PS.Network_XHR_Internal = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Network_XHR_Types = PS.Network_XHR_Types;
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    function newXMLHttpRequest() {   try {       return new ActiveXObject('Msxml2.XMLHTTP');   } catch (e) {       try {           return new ActiveXObject('Microsoft.XMLHTTP');       } catch (e) {           return new XMLHttpRequest();       }   }};
    function openImpl (config, xhr) {   return function () {       xhr.open(config.method,                config.url,                config.async,                config.user,                config.password);   }};
    function send (xhr) {   return function() {       xhr.send();   }};
    function sendWithBodyImpl (body, xhr) {   return function() {       xhr.send(body);   }};
    function getterImpl (prop, xhr) {   return function () {       return xhr[prop];   }};
    function setRequestHeaderImpl (header, value, xhr) {   return function() {       xhr.setRequestHeader(header, value);   }};
    function setterImpl (prop, v, xhr) {   return function () {       xhr[prop] = v;   }};
    function encodeUrlParams (obj) {   var str = '';   for (var key in obj) {       str += key + '=' + encodeURIComponent(obj[key]) + '&';   }   return str.slice(0,-1);};
    var setWithCredentials = Data_Function.runFn3(setterImpl)("withCredentials");
    var setTimeout = Data_Function.runFn3(setterImpl)("timeout");
    var setRequestHeader = Data_Function.runFn3(setRequestHeaderImpl);
    var setOnTimeout = Data_Function.runFn3(setterImpl)("ontimeout");
    var setOnReadyStateChange = Data_Function.runFn3(setterImpl)("onreadystatechange");
    var setOnProgress = Data_Function.runFn3(setterImpl)("onprogress");
    var setOnLoadEnd = Data_Function.runFn3(setterImpl)("onloadend");
    var setOnLoad = Data_Function.runFn3(setterImpl)("onload");
    var setOnError = Data_Function.runFn3(setterImpl)("onerror");
    var setOnAbort = Data_Function.runFn3(setterImpl)("onabort");
    var sendWithBody = Data_Function.runFn2(sendWithBodyImpl);
    var open = Data_Function.runFn2(openImpl);
    var getStatus = Data_Function.runFn2(getterImpl)("status");
    var getResponseText = Data_Function.runFn2(getterImpl)("responseText");
    var getReadyState = function (xhr) {
        return Prelude["<$>"](Control_Monad_Eff.functorEff)(Network_XHR_Types.parseReadyState)(getterImpl("readyState", xhr));
    };
    var defaultOpenConfig = {
        method: "GET", 
        url: "/", 
        async: true, 
        user: "", 
        password: ""
    };
    return {
        defaultOpenConfig: defaultOpenConfig, 
        encodeUrlParams: encodeUrlParams, 
        getReadyState: getReadyState, 
        getResponseText: getResponseText, 
        getStatus: getStatus, 
        newXMLHttpRequest: newXMLHttpRequest, 
        open: open, 
        send: send, 
        sendWithBody: sendWithBody, 
        setOnAbort: setOnAbort, 
        setOnError: setOnError, 
        setOnLoad: setOnLoad, 
        setOnLoadEnd: setOnLoadEnd, 
        setOnProgress: setOnProgress, 
        setOnReadyStateChange: setOnReadyStateChange, 
        setOnTimeout: setOnTimeout, 
        setRequestHeader: setRequestHeader, 
        setTimeout: setTimeout, 
        setWithCredentials: setWithCredentials
    };
})();
var PS = PS || {};
PS.Network_XHR = (function () {
    "use strict";
    var Network_XHR_Internal = PS.Network_XHR_Internal;
    var Prelude = PS.Prelude;
    var Data_Foldable = PS.Data_Foldable;
    var Network_XHR_Types = PS.Network_XHR_Types;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Data_Tuple = PS.Data_Tuple;
    var XHRTask = {
        create: function (value) {
            return value;
        }
    };
    var Response = {
        create: function (value) {
            return value;
        }
    };
    var rawBody = Network_XHR_Types.RawBody.create;
    var getStatus = function (_384) {
        return Network_XHR_Internal.getStatus(_384);
    };
    var onSuccess = function (act) {
        return function (rs) {
            return function (res) {
                return function __do() {
                    var _16 = getStatus(res)();
                    return (Prelude["=="](Network_XHR_Types.eqReadyState)(rs)(Network_XHR_Types.DONE.value) && _16 === 200 ? act(res) : Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit))();
                };
            };
        };
    };
    var getResponseText = function (_382) {
        return Network_XHR_Internal.getResponseText(_382);
    };
    var defaultAjaxOptions = {
        method: "GET", 
        url: "/", 
        headers: [  ], 
        cache: true, 
        timeout: 0, 
        credentials: false, 
        async: true, 
        user: "", 
        password: "", 
        onAbort: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }, 
        onError: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }, 
        onLoad: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }, 
        onLoadEnd: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }, 
        onProgress: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }, 
        onReadyStateChange: function (_) {
            return function (__1) {
                return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
            };
        }, 
        onTimeout: function (_) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
        }
    };
    var ajax = function (conf) {
        return function (params) {
            return function (body) {
                var paramString = Network_XHR_Internal.encodeUrlParams(params);
                var url = paramString === "" ? conf.url : conf.url + ("?" + paramString);
                var openConfig = (function () {
                    var _701 = {};
                    for (var _702 in Network_XHR_Internal.defaultOpenConfig) {
                        if (Network_XHR_Internal.defaultOpenConfig.hasOwnProperty(_702)) {
                            _701[_702] = Network_XHR_Internal.defaultOpenConfig[_702];
                        };
                    };
                    _701.method = conf.method;
                    _701.url = url;
                    _701.async = conf.async;
                    _701.user = conf.user;
                    _701.password = conf.password;
                    return _701;
                })();
                var headers = conf.cache ? conf.headers : Prelude[":"](new Data_Tuple.Tuple("Pragma", "no-cache"))(Prelude[":"](new Data_Tuple.Tuple("Cache-Control", "no-cache"))(Prelude[":"](new Data_Tuple.Tuple("IF-Modified-Since", "Thu, 01 Jun 1970 00:00:00 GMT"))(conf.headers)));
                return function __do() {
                    var _15 = Network_XHR_Internal.newXMLHttpRequest();
                    Network_XHR_Internal.open(openConfig)(_15)();
                    (conf.async ? function __do() {
    Network_XHR_Internal.setTimeout(conf.timeout)(_15)();
    return Network_XHR_Internal.setWithCredentials(conf.credentials)(_15)();
} : Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit))();
                    Network_XHR_Internal.setOnAbort(conf.onAbort(_15))(_15)();
                    Network_XHR_Internal.setOnError(conf.onError(_15))(_15)();
                    Network_XHR_Internal.setOnLoad(conf.onLoad(_15))(_15)();
                    Network_XHR_Internal.setOnLoadEnd(conf.onLoadEnd(_15))(_15)();
                    Network_XHR_Internal.setOnProgress(conf.onProgress(_15))(_15)();
                    Network_XHR_Internal.setOnTimeout(conf.onTimeout(_15))(_15)();
                    Network_XHR_Internal.setOnReadyStateChange(function __do() {
                        var _14 = Network_XHR_Internal.getReadyState(_15)();
                        return conf.onReadyStateChange(_14)(_15)();
                    })(_15)();
                    Data_Foldable.for_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(headers)(function (_378) {
                        return Network_XHR_Internal.setRequestHeader(_378.value0)(_378.value1)(_15);
                    })();
                    (function () {
                        if (body instanceof Network_XHR_Types.NoBody) {
                            return Network_XHR_Internal.send(_15);
                        };
                        if (body instanceof Network_XHR_Types.RawBody) {
                            return Network_XHR_Internal.sendWithBody(body.value0)(_15);
                        };
                        if (body instanceof Network_XHR_Types.UrlEncoded) {
                            return function __do() {
                                Network_XHR_Internal.setRequestHeader("Content-Type")("application/x-www-form-urlencoded")(_15)();
                                return Network_XHR_Internal.sendWithBody(body.value0)(_15)();
                            };
                        };
                        if (body instanceof Network_XHR_Types.Multipart) {
                            return Network_XHR_Internal.sendWithBody(body.value0)(_15);
                        };
                        throw new Error("Failed pattern match");
                    })()();
                    return _15;
                };
            };
        };
    };
    var get = function (c) {
        return function (u) {
            return function (p) {
                return ajax((function () {
                    var _712 = {};
                    for (var _713 in c) {
                        if (c.hasOwnProperty(_713)) {
                            _712[_713] = c[_713];
                        };
                    };
                    _712.method = "GET";
                    _712.url = u;
                    return _712;
                })())(p)(Network_XHR_Types.NoBody.value);
            };
        };
    };
    return {
        ajax: ajax, 
        defaultAjaxOptions: defaultAjaxOptions, 
        get: get, 
        getResponseText: getResponseText, 
        getStatus: getStatus, 
        onSuccess: onSuccess, 
        rawBody: rawBody
    };
})();
var PS = PS || {};
PS.Text_Smolder_Renderer_String = (function () {
    "use strict";
    var Data_String = PS.Data_String;
    var Prelude = PS.Prelude;
    var Data_Map = PS.Data_Map;
    var Text_Smolder_Renderer_Util = PS.Text_Smolder_Renderer_Util;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    var renderNode = function (_390) {
        if (_390 instanceof Text_Smolder_Renderer_Util.Element) {
            var showTail = function (_391) {
                if (_391.length === 0) {
                    return "/>";
                };
                return ">" + (Data_String.joinWith("")(Prelude["<$>"](Data_Array.functorArray)(Prelude.show(showNode))(_391)) + ("</" + (_390.value0 + ">")));
            };
            var showAttrs = function (a_1) {
                var pair = function (k) {
                    return " " + (k + (function () {
                        var _716 = Data_Map.lookup(Prelude.ordString)(k)(a_1);
                        if (_716 instanceof Data_Maybe.Just) {
                            return "=\"" + (_716.value0 + "\"");
                        };
                        if (_716 instanceof Data_Maybe.Nothing) {
                            return "";
                        };
                        throw new Error("Failed pattern match");
                    })());
                };
                return Data_String.joinWith("")(Prelude["<$>"](Data_Array.functorArray)(pair)(Data_Map.keys(a_1)));
            };
            return "<" + (_390.value0 + (showAttrs(_390.value1) + showTail(_390.value2)));
        };
        if (_390 instanceof Text_Smolder_Renderer_Util.Text) {
            return _390.value0;
        };
        throw new Error("Failed pattern match");
    };
    var showNode = new Prelude.Show(renderNode);
    var render = function (m) {
        return Data_String.joinWith("")(Prelude["<$>"](Data_Array.functorArray)(renderNode)(Text_Smolder_Renderer_Util.renderMarkup(m)));
    };
    return {
        render: render, 
        renderNode: renderNode, 
        showNode: showNode
    };
})();
var PS = PS || {};
PS.Util = (function () {
    "use strict";
    var Data_Maybe = PS.Data_Maybe;
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    var maybeFail = function (b) {
        return Data_Maybe.maybe(new Data_Either.Left(b))(Data_Either.Right.create);
    };
    return {
        maybeFail: maybeFail
    };
})();
var PS = PS || {};
PS.Post = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Map = PS.Data_Map;
    var Data_JSON = PS.Data_JSON;
    var Util = PS.Util;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Either = PS.Data_Either;
    function Post(value0) {
        this.value0 = value0;
    };
    Post.create = function (value0) {
        return new Post(value0);
    };
    function Posts(value0) {
        this.value0 = value0;
    };
    Posts.create = function (value0) {
        return new Posts(value0);
    };
    var postToJSON = new Data_JSON.ToJSON(function (_395) {
        return Data_JSON.JObject.create(Data_Map.fromList(Prelude.ordString)([ Data_Tuple.Tuple.create("nick")(Data_JSON.toJSON(Data_JSON.stringToJSON)(_395.value0.nick)), Data_Tuple.Tuple.create("text")(Data_JSON.toJSON(Data_JSON.stringToJSON)(_395.value0.text)), Data_Tuple.Tuple.create("date")(Data_JSON.toJSON(Data_JSON.stringToJSON)(_395.value0.date)) ]));
    });
    var postFromJSON = new Data_JSON.FromJSON(function (_396) {
        if (_396 instanceof Data_JSON.JObject) {
            return Prelude[">>="](Data_Either.bindEither)(Util.maybeFail("no nick")(Data_Map.lookup(Prelude.ordString)("nick")(_396.value0)))(function (_19) {
                if (_19 instanceof Data_JSON.JString) {
                    return Prelude[">>="](Data_Either.bindEither)(Util.maybeFail("no text")(Data_Map.lookup(Prelude.ordString)("text")(_396.value0)))(function (_18) {
                        if (_18 instanceof Data_JSON.JString) {
                            return Prelude[">>="](Data_Either.bindEither)(Prelude["return"](Data_Either.monadEither)(Data_Maybe.maybe(new Data_JSON.JString("??"))(Prelude.id(Prelude.categoryArr))(Data_Map.lookup(Prelude.ordString)("date")(_396.value0))))(function (_17) {
                                if (_17 instanceof Data_JSON.JString) {
                                    return Prelude["return"](Data_Either.monadEither)(new Post({
                                        nick: _19.value0, 
                                        text: _18.value0, 
                                        date: _17.value0
                                    }));
                                };
                                throw new Error("Failed pattern match");
                            });
                        };
                        throw new Error("Failed pattern match");
                    });
                };
                throw new Error("Failed pattern match");
            });
        };
        return Data_JSON.fail("Post parse fail: should be Object");
    });
    var postsFromJSON = new Data_JSON.FromJSON(function (_397) {
        if (_397 instanceof Data_JSON.JObject) {
            return Prelude[">>="](Data_Either.bindEither)(Util.maybeFail("no comments")(Data_Map.lookup(Prelude.ordString)("comments")(_397.value0)))(function (_21) {
                if (_21 instanceof Data_JSON.JArray) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(Data_JSON.parseJSON(postFromJSON))(_21.value0))(function (_20) {
                        return Prelude["return"](Data_Either.monadEither)(new Posts(_20));
                    });
                };
                throw new Error("Failed pattern match");
            });
        };
        return Data_JSON.fail("Posts parse fail: should be Object");
    });
    return {
        Post: Post, 
        Posts: Posts, 
        postFromJSON: postFromJSON, 
        postToJSON: postToJSON, 
        postsFromJSON: postsFromJSON
    };
})();
var PS = PS || {};
PS.HTML = (function () {
    "use strict";
    var Text_Smolder_Renderer_String = PS.Text_Smolder_Renderer_String;
    var Text_Smolder_HTML = PS.Text_Smolder_HTML;
    var Text_Smolder_HTML_Attributes = PS.Text_Smolder_HTML_Attributes;
    var Prelude = PS.Prelude;
    var Text_Smolder_Markup = PS.Text_Smolder_Markup;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Array = PS.Data_Array;
    var Post = PS.Post;
    var Data_Monoid = PS.Data_Monoid;
    var renderPost = function (_398) {
        return Text_Smolder_Renderer_String.render(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupMF)(Text_Smolder_HTML.div)(Text_Smolder_HTML_Attributes.className("comment"))(Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_HTML.h2(Text_Smolder_Markup.text(_398.value0.nick + (" @ " + _398.value0.date))))(function () {
            return Text_Smolder_HTML.p(Text_Smolder_Markup.text(_398.value0.text));
        })));
    };
    var renderPosts = function (_399) {
        return Data_Foldable.mconcat(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(Data_Array.map(renderPost)(_399.value0));
    };
    var renderForm = Text_Smolder_Renderer_String.render(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupMF)(Text_Smolder_HTML.div)(Text_Smolder_Markup.attribute("id")("comment_input_form"))(Text_Smolder_HTML.form(Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_Markup.text("Nick:"))(function () {
        return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupM)(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupM)(Text_Smolder_HTML.input)(Text_Smolder_Markup.attribute("id")("comment_input_nick")))(Text_Smolder_HTML_Attributes["type'"]("text")))(function () {
            return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_HTML.br)(function () {
                return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_Markup.text("Message:"))(function () {
                    return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_HTML.br)(function () {
                        return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupMF)(Text_Smolder_HTML.textarea)(Text_Smolder_Markup.attribute("id")("comment_input_text"))(Text_Smolder_Markup.text("")))(function () {
                            return Prelude[">>="](Text_Smolder_Markup.bindMarkupM)(Text_Smolder_HTML.br)(function () {
                                return Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupM)(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupM)(Text_Smolder_Markup["!"](Text_Smolder_Markup.attributableMarkupM)(Text_Smolder_HTML.input)(Text_Smolder_HTML_Attributes["type'"]("button")))(Text_Smolder_Markup.attribute("onClick")("PS.Comments.postComment()")))(Text_Smolder_HTML_Attributes.value("Send!"));
                            });
                        });
                    });
                });
            });
        });
    }))));
    var renderFull = function (p) {
        return renderPosts(p) + renderForm;
    };
    return {
        renderForm: renderForm, 
        renderFull: renderFull, 
        renderPost: renderPost, 
        renderPosts: renderPosts
    };
})();
var PS = PS || {};
PS.Config = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var siteId = site_id;
    var apiHost = api_host;
    function getPath(win) {    return function () {        return win.location.pathname;    } };
    return {
        apiHost: apiHost, 
        getPath: getPath, 
        siteId: siteId
    };
})();
var PS = PS || {};
PS.Comments = (function () {
    "use strict";
    var Data_DOM_Simple_Events = PS.Data_DOM_Simple_Events;
    var Data_DOM_Simple_Window = PS.Data_DOM_Simple_Window;
    var Prelude = PS.Prelude;
    var Debug_Trace = PS.Debug_Trace;
    var Data_DOM_Simple_Element = PS.Data_DOM_Simple_Element;
    var Config = PS.Config;
    var Network_XHR = PS.Network_XHR;
    var Data_Maybe = PS.Data_Maybe;
    var HTML = PS.HTML;
    var Data_JSON = PS.Data_JSON;
    var Date = PS.Date;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Post = PS.Post;
    var Data_DOM_Simple_Document = PS.Data_DOM_Simple_Document;
    var Data_Tuple = PS.Data_Tuple;
    var commentsUpdate = function (div) {
        return function (response) {
            return function __do() {
                var _25 = Network_XHR.getResponseText(response)();
                return (function () {
                    var postsHtml = Data_Maybe.maybe("wrong json reply")(HTML.renderFull)(Data_JSON.decode(Post.postsFromJSON)(_25));
                    return Data_DOM_Simple_Element.setInnerHTML(Data_DOM_Simple_Element.htmlElement)(postsHtml)(div);
                })()();
            };
        };
    };
    var commentsTimeout = function (div) {
        return function (response) {
            return Data_DOM_Simple_Element.setInnerHTML(Data_DOM_Simple_Element.htmlElement)("timeout")(div);
        };
    };
    var commentsError = function (div) {
        return function (response) {
            return Data_DOM_Simple_Element.setInnerHTML(Data_DOM_Simple_Element.htmlElement)("error")(div);
        };
    };
    var apiCallAddr = function (api) {
        return Config.apiHost + api;
    };
    var reloadComments = function (msg) {
        return function __do() {
            Debug_Trace.trace("loading comments..")();
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Window.document(Data_DOM_Simple_Window.htmlWindow)(Data_DOM_Simple_Window.globalWindow))(Data_DOM_Simple_Element.querySelector(Data_DOM_Simple_Document.htmlDocumentElement)("#comments")))(function (_24) {
                if (_24 instanceof Data_Maybe.Just) {
                    return function __do() {
                        Data_DOM_Simple_Element.setInnerHTML(Data_DOM_Simple_Element.htmlElement)(msg)(_24.value0)();
                        var _23 = Config.getPath(Data_DOM_Simple_Window.globalWindow)();
                        var _22 = Network_XHR.get((function () {
                            var _744 = {};
                            for (var _745 in Network_XHR.defaultAjaxOptions) {
                                if (Network_XHR.defaultAjaxOptions.hasOwnProperty(_745)) {
                                    _744[_745] = Network_XHR.defaultAjaxOptions[_745];
                                };
                            };
                            _744.onReadyStateChange = Network_XHR.onSuccess(commentsUpdate(_24.value0));
                            _744.onTimeout = commentsTimeout(_24.value0);
                            _744.onError = commentsError(_24.value0);
                            return _744;
                        })())(apiCallAddr("get_comments/") + (Config.siteId + ("/root" + _23)))({})();
                        return Prelude.unit;
                    };
                };
                throw new Error("Failed pattern match");
            })();
        };
    };
    var onLoad = function (_400) {
        return function __do() {
            reloadComments("loading comments..")();
            return Prelude.unit;
        };
    };
    var main = Data_DOM_Simple_Events.addUIEventListener(Data_DOM_Simple_Events.uiEventTargetHTMLWindow)(Data_DOM_Simple_Events.uiEventDOMEvent)(Data_DOM_Simple_Events.LoadEvent.value)(onLoad)(Data_DOM_Simple_Window.globalWindow);
    var postComment = function __do() {
        Debug_Trace.trace("sending message..")();
        return Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Window.document(Data_DOM_Simple_Window.htmlWindow)(Data_DOM_Simple_Window.globalWindow))(Data_DOM_Simple_Element.querySelector(Data_DOM_Simple_Document.htmlDocumentElement)("#comment_input_nick")))(function (_32) {
            if (_32 instanceof Data_Maybe.Just) {
                return Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Data_DOM_Simple_Window.document(Data_DOM_Simple_Window.htmlWindow)(Data_DOM_Simple_Window.globalWindow))(Data_DOM_Simple_Element.querySelector(Data_DOM_Simple_Document.htmlDocumentElement)("#comment_input_text")))(function (_31) {
                    if (_31 instanceof Data_Maybe.Just) {
                        return function __do() {
                            var _30 = Data_DOM_Simple_Element.value(Data_DOM_Simple_Element.htmlElement)(_32.value0)();
                            var _29 = Data_DOM_Simple_Element.value(Data_DOM_Simple_Element.htmlElement)(_31.value0)();
                            var _28 = Date.getDate();
                            var _27 = Config.getPath(Data_DOM_Simple_Window.globalWindow)();
                            return (function () {
                                var msg = Data_JSON.encode(Post.postToJSON)(new Post.Post({
                                    nick: _30, 
                                    text: _29, 
                                    date: _28
                                }));
                                return function __do() {
                                    var _26 = Network_XHR.ajax((function () {
                                        var _755 = {};
                                        for (var _756 in Network_XHR.defaultAjaxOptions) {
                                            if (Network_XHR.defaultAjaxOptions.hasOwnProperty(_756)) {
                                                _755[_756] = Network_XHR.defaultAjaxOptions[_756];
                                            };
                                        };
                                        _755.method = "POST";
                                        _755.headers = [ new Data_Tuple.Tuple("Content-Type", "application/json") ];
                                        _755.onReadyStateChange = Network_XHR.onSuccess(function (_) {
                                            return reloadComments("Comment added, reloading..");
                                        });
                                        _755.url = apiCallAddr("add_comment/") + (Config.siteId + ("/root" + _27));
                                        return _755;
                                    })())({})(Network_XHR.rawBody(msg))();
                                    return Prelude.unit;
                                };
                            })()();
                        };
                    };
                    throw new Error("Failed pattern match");
                });
            };
            throw new Error("Failed pattern match");
        })();
    };
    return {
        apiCallAddr: apiCallAddr, 
        commentsError: commentsError, 
        commentsTimeout: commentsTimeout, 
        commentsUpdate: commentsUpdate, 
        main: main, 
        onLoad: onLoad, 
        postComment: postComment, 
        reloadComments: reloadComments
    };
})();
PS.Comments.main();
